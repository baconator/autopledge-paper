\subsubsection{Finding Pledge Call Locations }

The core of our analysis performs an in-order traversal of the call graph per code segment. A set \(A\) of system calls is generated by querying a single call in a precomputed table; the set \(A'\), by taking the union of a global context (passed in recursively) and the local context, computed by taking the union of all function local-instructions. Whenever \(A \cup A' < A'\), the function descends and attempts to discover another location in the code which would allow for a pledge call of higher granularity. If it fails, a pledge call is inserted after the initial call. Due to the previous passes, this will never insert a pledge call inside a function that may be called later on or inside of a cycle.